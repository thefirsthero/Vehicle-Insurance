(this.webpackJsonptest_task=this.webpackJsonptest_task||[]).push([[0],{11:function(e,t,a){},38:function(e,t,a){},64:function(e,t,a){"use strict";a.r(t);var n=a(1),c=a(0),r=a.n(c),s=a(30),i=a.n(s),o=(a(38),a(9)),l=a(4),j=a(8),u=a(2),b=r.a.createContext(),O=r.a.createContext(),d=function(e,t){switch(t.type){case"SET_CURR_USER":return console.log("STATE: ",e,"ACTION: ",t),{userInfo:Object(u.a)({},t.userInfo),isLoggedIn:t.isLoggedIn};case"LOG_OUT":return{userInfo:{},isLoggedIn:!1};default:return e}},h={State:b,Dispatch:O,Provider:function(e){var t=e.children,a=r.a.useReducer(d,{userInfo:{},isLoggedIn:!1}),c=Object(j.a)(a,2),s=c[0],i=c[1];return Object(n.jsx)(b.Provider,{value:s,children:Object(n.jsx)(O.Provider,{value:i,children:t})})}},p=[Object(n.jsx)(h.Provider,{})],g=function(e){var t=e.children;return p.reduce((function(e,t){return r.a.cloneElement(t,{children:e})}),t)},m=(a(11),a(32)),x=a(14),f=a.n(x),v=function(){var e=Object(c.useState)({name:"",login:"",email:"",password:"",birthdate:"",country:"Afghanistan"}),t=Object(j.a)(e,2),a=t[0],r=t[1],s=Object(c.useState)([]),i=Object(j.a)(s,2),o=i[0],b=i[1],O=Object(c.useState)({email:"",login:"",date:""}),d=Object(j.a)(O,2),p=d[0],g=d[1],x=Object(c.useState)(!0),v=Object(j.a)(x,2),y=v[0],I=v[1],C=Object(c.useContext)(h.Dispatch),S=Object(c.useRef)(null),N=Object(l.f)(),L=/([12]\d{3}-(0[1-9]|1[0-2])-(0[1-9]|[12]\d|3[01]))/;Object(c.useEffect)((function(){f.a.get("https://register-auth-app.herokuapp.com/api/countries").then((function(e){return b(Object(m.a)(e.data))}))}),[]);var E;return void 0!==o&&(E=o.map((function(e,t){return Object(n.jsx)("option",{children:e.nicename},t)}))),Object(n.jsxs)("div",{className:"App",children:[Object(n.jsx)("h1",{children:"Register"}),Object(n.jsxs)("form",{onSubmit:function(e){e.preventDefault(),a.birthdate.match(L)?(g(Object(u.a)(Object(u.a)({},p),{},{date:""})),f()({method:"post",url:"https://register-auth-app.herokuapp.com/api/register",data:Object(u.a)(Object(u.a)({},a),{},{timestamp:Math.floor(Date.now()/1e3)})}).then((function(e){200===e.data.code?(C({type:"SET_CURR_USER",userInfo:Object(u.a)({},e.data.logInInfo),isLoggedIn:!0}),N.push("/profile")):405===e.data.code&&(console.log(e.data),S.current.value="",g(Object(u.a)(Object(u.a)({},p),{},{email:e.data.message[0].email?"active":"",login:e.data.message[0].login?"active":""})))}))):g(Object(u.a)(Object(u.a)({},p),{},{date:"active"}))},children:[Object(n.jsx)("label",{className:"input-label",children:"Name"}),Object(n.jsx)("input",{type:"text",onChange:function(e){return r(Object(u.a)(Object(u.a)({},a),{},{name:e.target.value}))}}),Object(n.jsx)("label",{className:"input-label",children:"Login"}),Object(n.jsx)("input",{type:"text",onChange:function(e){return r(Object(u.a)(Object(u.a)({},a),{},{login:e.target.value}))}}),Object(n.jsx)("p",{className:"login-err "+p.login,children:"This login has already taken."}),Object(n.jsx)("label",{className:"input-label",children:"E-mail"}),Object(n.jsx)("input",{type:"email",onChange:function(e){return r(Object(u.a)(Object(u.a)({},a),{},{email:e.target.value}))}}),Object(n.jsx)("p",{className:"login-err "+p.email,children:"This email has already taken"}),Object(n.jsx)("label",{className:"input-label",children:"Date of Birth"}),Object(n.jsx)("input",{placeholder:"yyyy-mm-dd",type:"text",onChange:function(e){return r(Object(u.a)(Object(u.a)({},a),{},{birthdate:e.target.value}))}}),Object(n.jsx)("p",{className:"login-err "+p.date,children:"Invalid date"}),Object(n.jsx)("label",{className:"input-label",children:"Password"}),Object(n.jsx)("input",{type:"password",onChange:function(e){return r(Object(u.a)(Object(u.a)({},a),{},{password:e.target.value}))},ref:S}),Object(n.jsx)("label",{className:"input-label",children:"Country"}),Object(n.jsx)("select",{onChange:function(e){return r(Object(u.a)(Object(u.a)({},a),{},{country:e.target.value}))},children:E}),Object(n.jsxs)("label",{className:"checkbox-label",children:[Object(n.jsx)("input",{type:"checkbox",name:"terms",onChange:function(e){return I(!e.target.checked)}}),"agree with terms and conditions"]}),Object(n.jsx)("input",{type:"submit",value:"Submit",disabled:y})]})]})},y=function(){return Object(n.jsxs)("div",{className:"front-page",children:[Object(n.jsx)(o.b,{to:"/register",children:Object(n.jsx)("h1",{children:"Register"})}),Object(n.jsx)(o.b,{to:"/login",children:Object(n.jsx)("h1",{children:"Log In"})})]})},I=function(){var e=Object(c.useState)({emailOrLogin:"",password:""}),t=Object(j.a)(e,2),a=t[0],r=t[1],s=Object(c.useState)(""),i=Object(j.a)(s,2),o=i[0],b=i[1],O=Object(c.useContext)(h.Dispatch),d=Object(c.useRef)(null),p=Object(l.f)();return Object(n.jsxs)("div",{className:"App",children:[Object(n.jsx)("h1",{children:"Log In"}),Object(n.jsxs)("form",{onSubmit:function(e){e.preventDefault(),f()({method:"post",url:"https://register-auth-app.herokuapp.com/api/login",data:Object(u.a)({},a)}).then((function(e){200===e.data.code?(O({type:"SET_CURR_USER",userInfo:{email:e.data.userInfo[0].email,name:e.data.userInfo[0].name},isLoggedIn:!0}),p.push("/profile")):(b("active"),d.current.value="")}))},children:[Object(n.jsx)("input",{placeholder:"Email / Login",type:"text",onChange:function(e){return r(Object(u.a)(Object(u.a)({},a),{},{emailOrLogin:e.target.value}))}}),Object(n.jsx)("input",{ref:d,placeholder:"Password",type:"password",onChange:function(e){return r(Object(u.a)(Object(u.a)({},a),{},{password:e.target.value}))}}),Object(n.jsx)("p",{className:"login-err "+o,children:"Enter correct data"}),Object(n.jsx)("input",{type:"submit",value:"Submit"})]})]})},C=function(){var e=Object(c.useContext)(h.State),t=Object(c.useContext)(h.Dispatch),a=Object(l.f)();return Object(n.jsxs)("div",{className:"profile",children:[Object(n.jsx)("h1",{children:"E-mail: "+e.userInfo.email}),Object(n.jsx)("h1",{children:"Name: "+e.userInfo.name}),Object(n.jsx)("button",{className:"logout-btn",onClick:function(){t({type:"LOG_OUT"}),a.push("/")},children:"Logout"})]})};var S=function(){var e=Object(c.useContext)(h.State);return Object(n.jsx)(n.Fragment,{children:Object(n.jsxs)(o.a,{children:[Object(n.jsx)(l.b,{exact:!0,path:"/",component:y,children:e.isLoggedIn?Object(n.jsx)(l.a,{to:"/profile"}):Object(n.jsx)(y,{})}),Object(n.jsx)(l.b,{path:"/register",component:v}),Object(n.jsx)(l.b,{path:"/login/",component:I}),Object(n.jsx)(l.b,{path:"/profile",component:C})]})})};i.a.render(Object(n.jsx)(r.a.StrictMode,{children:Object(n.jsx)(g,{children:Object(n.jsx)(S,{})})}),document.getElementById("root"))}},[[64,1,2]]]);
//# sourceMappingURL=main.cf9475b1.chunk.js.map